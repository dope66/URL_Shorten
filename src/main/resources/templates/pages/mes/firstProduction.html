<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        select {
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 200px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
<form id="production-test-form">
<label for="productionTypeSelect">생산 유형
    <div id="productionTypeContainer">
        <select id="productionTypeSelect" required>
            <option value="" disabled selected>선택하세요</option>
        </select>
    </div>
</label>
<label for="productionNumber">품 번 </label><select type="text" readonly name="productionNumber" id="productionNumber"></select>
<label for="productionName">품 명</label><input type="text" readonly name="productionName" id="productionName">
<label for="processWorker">공정원 </label><select name="processWorker" id="processWorker"></select>
<label for="test1"></label>검사 1<input type="text" readonly value="검사 1" id="test1">
<label for="test2"></label>검사 2<input type="text" readonly value="검사 2" id="test2">
    <button>등록</button>
</form>
</body>

<script src="/static/js/selectNumberAndName.js"></script>
<script>
    const productionTestForm = document.getElementById("production-test-form");
    productionTestForm.addEventListener('submit', (event) => {
        event.preventDefault();
        const productionTypeSelect = document.getElementById('productionType').value;
        const productionNumber = document.getElementById("productionNumber").value;
        const productionName = document.getElementById('productionName').value;
        const processWorker = document.getElementById('processWorker').value;


        const newTest = {productionTypeSelect, productionNumber, productionName, processWorker};


        const confirmed = window.confirm('정말로 등록하시겠습니까?');
        if (confirmed) {
            // 확인을 선택한 경우에만 등록 진행
            fetch('/api/mes/firstProductionTest', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(newTest)
            })
                .then(response => {
                    if (response.ok) {
                        alert('등록이 완료되었습니다.');
                        window.close();
                    }
                })
                .catch(error => {
                    console.error('fetch 오류 요청 ', error);
                });
        }
    });


</script>
<script>

    const workerNameSelect = document.getElementById("workerName");
    fetch(`/api/mes/getWorkerName`)
        .then(response => response.json())
        .then(workerName => {
            workerNameSelect.innerHTML = '';
            workerNameSelect.value=workerName;
        })
        .catch(error => {
            console.error('fetch 오류 요청 ', error);
        });

</script>

</html>