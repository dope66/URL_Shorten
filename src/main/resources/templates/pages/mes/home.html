<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MES</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        #sidebar{
            color: #FFFFFF;
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 250px;
            height: 100%;
            overflow: auto;
        }
        /* 사이드바 헤더 및 링크 스타일 */
        .sidebar-header {
            padding: 10px;
            background: #27282a;
            color: #FFFFFF;
        }

        .side-menu {
            display: none;
            position: fixed;
            left: 250px; /* 기본 사이드바의 너비에 맞춤 */
            top: 0;
            width: 200px; /* 추가 사이드 메뉴의 너비 */
            height: 100%;
            background-color: #f8f9fa; /* 밝은 배경색 */
            overflow-y: auto;
            color: #27282a;
=
        }
        .sidebar, .side-menu ul {
            list-style-type: none; /* UL 요소 내부의 모든 리스트 아이템의 점을 제거 */
            padding-left: 0; /* 왼쪽 패딩 제거 */
        }

        .nav-link {
            text-decoration: none; /* 링크의 밑줄 제거 */
            color: #27282a; /* 링크의 텍스트 색상 설정 */
        }
        .nav-item a{
            color:white;
        }
        #adminMenu,#workerMenu{
            background-color:#27282a ;
        }

    </style>

</head>
<body>

<div id="sidebar" class="sidebar bg-dark">
    <div class="sidebar-header">
        <a href="/mes/home" class="navbar-brand" style="color: #FFFFFF">MES 시스템</a>
    </div>
    <ul class="nav flex-column">
        <li class="nav-item"><a href="#" class="nav-link toggle-menu" data-target="adminMenu">관리자</a></li>
        <li class="nav-item"><a href="#" class="nav-link toggle-menu" data-target="workerMenu">작업자</a></li>
    </ul>
</div>
<!-- 관리자 하위 메뉴 -->
<div id="adminMenu" class="side-menu">
    <ul>
        <li class="nav-item"><a href="/mes/worker" id="loadWorkerPage" class="nav-link">공정원 페이지</a></li>
        <li class="nav-item"><a href="/mes/testSearch" class="nav-link">조회 검색</a></li>
        <li class="nav-item"><a class="nav-link" href="/mes/selectProductionOrder">생산 지시</a></li>
        <li class="nav-item"><a class="nav-link" href="/mes/orderList">생산지시 현황</a></li>
        <li class="nav-item"><a class="nav-link" href="#">모니터링</a></li>
        <li class="nav-item"><a class="nav-link" href="#">통계분석</a></li>
    </ul>
</div>
<!-- 작업자 하위 메뉴 -->
<div id="workerMenu" class="side-menu">
    <ul>
        <li class="nav-item"><a href="#" class="nav-link" id="productionOrderLink">작업자 생산지시 화면</a>
            <select class="custom-select" id="processEquipmentSelect" style="background-color: #c7c7c7">
                <option selected>생산설비 선택</option>
            </select>
        </li>
        <li class="nav-item"><a class="nav-link" href="/mes/productLog">생산일지</a></li>
    </ul>
</div>

<div id="change-page-body">
    <!--여기에 페이지 이동한 내용이 오도록 -->
</div>
</body>
<!--<script>-->
<!--    $("#loadWorkerPage").click(function(){-->
<!--        console.log("Load Worker Page clicked");-->
<!--        $("#change-page-body").load("/mes/worker #register-all", function(response, status, xhr) {-->
<!--            if (status == "error") {-->
<!--                console.log("Error loading the page: ", xhr.status, xhr.statusText);-->
<!--            }-->
<!--        });-->
<!--    });-->

<!--</script>-->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    document.getElementById('adminMenu').addEventListener('click', function() {
        document.getElementById('adminSidebar').style.display = 'block';
        document.getElementById('workerSidebar').style.display = 'none';
    });

    document.getElementById('workerMenu').addEventListener('click', function() {
        document.getElementById('workerSidebar').style.display = 'block';
        document.getElementById('adminSidebar').style.display = 'none';
    });
    // document.getElementById('adminMenu').addEventListener('click', function() {
    //     var adminMenu = document.getElementById('adminMenu');
    //     var workerMenu = document.getElementById('workerMenu');
    //     if (adminMenu.style.display === "block") {
    //         adminMenu.style.display = "none";
    //     } else {
    //         adminMenu.style.display = "block";
    //         workerMenu.style.display = "none";
    //     }
    // });
    //
    // document.getElementById('workerMenu').addEventListener('click', function() {
    //     var workerMenu = document.getElementById('workerMenu');
    //     var adminMenu = document.getElementById('adminMenu');
    //     if (workerMenu.style.display === "block") {
    //         workerMenu.style.display = "none";
    //     } else {
    //         workerMenu.style.display = "block";
    //         adminMenu.style.display = "none";
    //     }
    // });

    document.querySelectorAll('.toggle-menu').forEach(function(menu) {
        menu.addEventListener('click', function(e) {
            e.preventDefault();
            var targetMenu = document.getElementById(e.target.dataset.target);
            if (targetMenu.style.display === "block") {
                targetMenu.style.display = "none";
            } else {
                // 모든 사이드 메뉴 숨기기
                document.querySelectorAll('.side-menu').forEach(function(menu) {
                    menu.style.display = "none";
                });
                // 선택된 메뉴 보이기
                targetMenu.style.display = "block";
            }
        });
    });


</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const processEquipmentSelect = document.getElementById('processEquipmentSelect');
        const productionOrderLink = document.getElementById('productionOrderLink');
        let selectedProcessName = '';
        let selectedEquipmentName = '';

        fetch(`/api/worker/getProcessAndEquipment`)
            .then(response => response.json())
            .then(processAndEquipment => {
                processAndEquipment.forEach(item => {
                    const value = item.replace(' ', '-');
                    const option = new Option(item, value);
                    processEquipmentSelect.add(option);
                });
            });

        processEquipmentSelect.addEventListener('change', function () {
            const selectedValue = this.value.split('-');
            selectedProcessName = encodeURIComponent(selectedValue[0]);
            selectedEquipmentName = encodeURIComponent(selectedValue[1] || '');
        });

        productionOrderLink.addEventListener('click', function (e) {
            e.preventDefault();
            if (!selectedProcessName || !selectedEquipmentName) {
                alert('공정과 설비를 선택해주세요.');
                return;
            }
            window.location.href = `/mes/productionOrder?processName=${selectedProcessName}&equipmentName=${selectedEquipmentName}`;
        });
    });
</script>
</html>
